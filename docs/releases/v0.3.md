# LogOps v0.3 — CLI-first, walidacja wejścia, observability & alerty, dokumentacja

## Highlights
- Orchestracja „CLI first”: `tools/run_scenario.py` (czas trwania, EPS, staty per level).
- Gateway: walidacja wejścia (Pydantic), czytelne 400/422, `logops_parse_errors_total`.
- Observability: dashboard Grafany (EPS, levels, scenarios, missing ts/level, parse errors).
- Alerty: gotowe reguły Prometheusa (gateway down, brak/niski/wysoki ingest, inflight, missing).
- Dokumentacja: `.env.example`, `docs/env.md`, README emiterów i orchestratora.

## Zrealizowane milestone’y
**Emitery i scenariusze**
- [x] `scenarios/` z profilami (`default.yaml`, `burst.yaml`, `quiet-then-spike.yaml`, `high-errors.yaml`)
- [x] Spójny nagłówek `X-Emitter` w emiterach

**Orchestracja „CLI first”**
- [x] `tools/run_scenario.py` + podsumowanie per level
- [x] Makefile targety (scenario:run, emit:*)

**Gateway**
- [x] Walidacja Pydantic (400/422 z indeksami błędnych rekordów)
- [x] Metryki: `logops_ingested_total`, `logops_missing_ts_total`, `logops_missing_level_total`, `logops_parse_errors_total`
- [x] Warianty per-scenario (`logops_*_scenario_total`)

**Observability i alerty**
- [x] Dashboard (Prometheus + Loki): EPS, inflight, missing, parse, scenariusze, top emitters, live tail
- [x] Reguły alertów z sensownymi progami i `for`

**Dokumentacja**
- [x] `docs/services/orchestrator.md`
- [x] `.env.example` + `docs/env.md`
- [x] `docs/emitters/*` + `docs/tools/run_scenario.md`

## Szybki sanity-check
```bash
curl -s http://localhost:8080/healthz | jq
curl -s http://localhost:8080/metrics | grep -E 'logops_(ingested|missing_|parse|inflight)'
curl -s -XPOST localhost:8080/v1/logs -H 'Content-Type: application/json' -H 'X-Emitter: test' \
  -d '[{"msg":"ok"},123,{"msg":"ok2"}]' | jq
curl -s http://localhost:8080/metrics | grep logops_parse_errors_total
```
## Ważne zmienne .env

- `LOGOPS_ENCRYPT_PII`, `LOGOPS_SECRET_KEY` (Fernet)

- `LOGOPS_SINK_FILE`, `LOGOPS_SINK_DIR`

- `LOGOPS_RETENTION_DAYS`, `LOGOPS_ARCHIVE_MODE`

- `LOGOPS_HOUSEKEEP_AUTORUN`, `LOGOPS_HOUSEKEEP_INTERVAL_SEC`
