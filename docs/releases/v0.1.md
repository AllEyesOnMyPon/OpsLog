# LogOps v0.1 – Initial Scaffold & Gateway Basics 
---

## Highlights
- Inicjalizacja repozytorium i struktury katalogów (`services/`, `infra/`, `docs/`, `tests/`).
- Utworzenie środowiska Python `.venv` i instalacja paczek bazowych (`fastapi`, `uvicorn`, `pydantic`, `requests`, `python-dotenv`).
- Pierwsza wersja **Ingest Gateway (FastAPI)**:
  - Endpoint `/healthz`.
  - Endpoint `/v1/logs` przyjmujący JSON body.
  - Podstawowa normalizacja pól (`ts`, `level`, `msg`) i liczniki braków (`missing_ts`, `missing_level`).
  - Logger zamiast `print`.
- Pierwsze **emitery**:
  - `emitter_json` – strukturalny JSON (server-style).
  - `emitter_minimal` – minimalny payload (`msg`).
- Testy integracyjne lokalnie (`Invoke-RestMethod` w PowerShell).  
- Porządki w repo: usunięcie `services/ingest-gateway` → zastąpienie `services/ingest_gateway`.

---

## Details

### Repo setup
- `git init` + scaffold katalogów (`services/ingest_gateway`, `infra/docker`, `docs`, `tests/unit`).
- Dodanie `README.md` i `.gitignore`.
- Pierwszy commit: `init: scaffold repo`.

### Virtualenv
- Utworzenie `.venv`.
- Instalacja wymaganych paczek.
- Wygenerowanie `services/ingest_gateway/requirements.txt`.

### Ingest Gateway
- `FastAPI` z endpointem `/healthz`.
- `POST /v1/logs` – początkowo błąd (query param), poprawione na `request.json()`.
- Dodanie normalizacji pól, liczników braków, loggera.

### Emitery
- `emitter_json`: generuje pełne rekordy (częściowo niekompletne przez `--partial-ratio`).
- `emitter_minimal`: tylko `msg` → wymusza uzupełnianie `ts` i `level` po stronie gateway.

### Testowanie
- `Invoke-RestMethod (irm)` w PowerShell działa poprawnie z JSON (polecany).
- `curl.exe` → problemy z escapowaniem stringów, używane tylko w cross-platform scriptach.

---

## Known Issues
- Brak jeszcze obsługi logów typu `text/plain` (syslog) i `text/csv`.
- Brak testów e2e (dopiero na roadmapie).
- Brak dokumentacji środowiskowej (uzupełnione w późniejszych wersjach).
